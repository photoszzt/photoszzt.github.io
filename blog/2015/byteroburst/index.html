<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <hr> <p>layout: post title: ByteRobust date: 2025-11-22T16:39:58-07:00 description: Robust LLM Training Infrastructure at ByteDance tags: paper-review categories: paper-review —</p> <h3 id="robust-llm-training-infrastructure-at-bytedance-link">Robust LLM Training Infrastructure at ByteDance <a href="https://arxiv.org/abs/2509.16293" rel="external nofollow noopener" target="_blank">link</a> </h3> <p>Control plane</p> <ol> <li>Robust controller <ol> <li>Robust controller react to events from proactive realtime check: <ol> <li>High confidence event for a specific machine: force drain node, evict the machine, skip stop time diagnostics <ol> <li>GPU unavailability</li> <li>Disk fault</li> </ol> </li> <li>Network issue: tolerate several alerts before evict the machine. Policy: twice within 5 mins empirically <ol> <li>NIC and Network switch flapping can auto recover</li> </ol> </li> <li>If the restarted job fails again after machine eviction, it goes to a stop-time check procedure.</li> </ol> </li> <li>Robust controller analyze the logs <ol> <li>User space error: traceable to specific code modules from logs and exit codes, python exception -&gt; code rollback</li> <li>Training crashes/abnormal metrics, e.g., NaN losses, arise without a clear culprit -&gt; stop time check</li> <li>Performance anomalies: 0 RDMA traffic within 10 mins, low TensorCore utilization -&gt; aggregation analysis</li> </ol> </li> </ol> </li> <li>Runtime analyzer <ol> <li>Aggregation analysis <ol> <li>Parses process trees in each training pod to identify training related processes (torchrun, dataloader, checkpoint process)</li> <li>Stack traces from these identified processes are aggregated into multiple groups via string matching to differentiate abnormal sources <ol> <li>The dominant groups are deemed healthy.</li> <li>Remaining groups are classified as outliers.</li> </ol> </li> <li>Find shared parallel groups for those outliers and isolate the corresponding machines</li> </ol> </li> <li>Fail slow (MFU decline): <ol> <li>Repeat aggregation every 10s, flag the parallel group with the most outliers at each round.</li> <li>Parallel group with the highest cumulative flag count across 5 rounds is marked as the degrader for over-eviction.</li> </ol> </li> </ol> </li> </ol> <p>Data plane (Robust agent in each training pod)</p> <ol> <li>Monitor <ol> <li>System inspection (Proactive realtime check): <ol> <li>Network: NIC down or jitter, packet loss rate, switches down</li> <li>GPU: status of DCGM service, PCIe bandwidth, memory row remapping, and GPU temperature, etc.</li> <li>Host: OS kernel event (Xid in dmesg)</li> </ol> </li> <li>Metics collection <ol> <li>Workload specific training metrics from wandb: loss, gradient norm, MFR, etc <ol> <li>Fatal signal: 5× increase in loss/gradient norms, NaN values</li> </ol> </li> <li>stdout/stderr logs and process exit codes, which serve as hints for diagnostics</li> <li>Events: Significant declines serve as a signal for potential job hangs and MFU declines. <ol> <li>CUDA</li> <li>RDMA: traffic</li> <li>Host</li> <li>Storage</li> </ol> </li> </ol> </li> </ol> </li> <li>Diagnoser <ol> <li>NaN loss diagnosis <ol> <li>Standard GPU and network tests first (EUD and NCCL tests). <ol> <li>Intra machine all-to-all test to verify bandwidth</li> <li>Inter machine all-gather NCCL test to verify connectivity and integrity of data transfer with “neighboring” machines.</li> </ol> </li> <li>Bitwise alignment test <ol> <li>Each machine initiates a reference model whose structure matches that of the target training job (dense models or MoE models).</li> <li>Load predefined weights, employs a specific parallelism configuration (e.g., TP=2, PP=2, DP=2 or EP=2, PP=2, DP=2), and executes one training step on fixed input to ensure reproducibility.</li> <li>The outputs from all machines are collected and analyzed to verify bit-wise accuracy.</li> <li>Machines that yield incorrect results are promptly isolated and removed.</li> <li>If this test does not identify any defective machines, reattempt and rollback are sequentially employed to settle potential transient failures and human errors.</li> </ol> </li> </ol> </li> <li>Job hang and MFU declines</li> </ol> </li> <li>On demand tracer</li> <li>CKPT manager</li> </ol> </body></html>